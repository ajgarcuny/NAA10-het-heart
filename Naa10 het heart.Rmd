---
title: "Naa10 het heart"
output: html_document
---

Naa10 heterozygous mutant (+/- or +/-) analysis

#Source data
##individual dataset
```{r}
library(tidyverse)

heart <- read.csv("https://docs.google.com/spreadsheets/d/e/2PACX-1vQ6Zsk-kGVqB3DlzX_VtZE5cRNqqM5NX5rfdp5t1kuEkH6PAKf76ozEFmqklqKIFZqWvjzcx_mOV5K6/pub?gid=0&single=true&output=csv",
                  header = T)


```

```{r}
head(heart)

##double-check genotypes of biological replicates
```


```{r}
##switched Name and Replicate fromn integers to factors
heart$Name <- as.factor(heart$Name)
heart$Replicate <- as.factor (heart$Replicate)
heart$Genotype <- as.factor(heart$Genotype)

head(heart)

##changed Name and Replicate from integer data to replicate data
```
```{r}
ggplot(heart,aes(x = Genotype,
                 y = Normalized.Signal,
                 color = Name,
                 shape = Replicate))+
  geom_point()+
  ylab("NAA10 signal normalized to
       REVERT total protein stain")+
  ggtitle("NAA10 levels in Naa10
          heterozygous mutant heart")

##if we added jitter as another layer, the data points would be duplicated
##in the resultant plot!
```




##Group-mean datasets in dplyr
```{r}
heart_gd <- group_by(heart,Genotype)

heart_gd <- summarise(heart)

heart_gd
```


#Summary data of Naa10 het heart and hypothesis testing

```{r}
##Summary statistics for Normalized NAA10 signal, grouped by genotype and technical replicate
##Replicate grouping pertains to replicate blot grouping

library(Rmisc)
heart_sum <- summarySE(heart, measurevar="Normalized.Signal", groupvars=c("Genotype","Replicate"))

heart_sum
```



```{r}
##Normalized NAA10 signal is grouped by genotype.
##N = 6 for both because the 3 biological replicates in each genotype
##were assayed twice

heart_sum1 <- summarySE(heart, measurevar="Normalized.Signal", groupvars=c("Genotype"))

heart_sum1
```

```{r}
#essentially looking to plot this onto the individual data plot
ggplot(heart_sum1, aes(x = Genotype, y = Normalized.Signal))+
  geom_point()+
  geom_errorbar(aes(ymin = Normalized.Signal - sd,
                ymax = Normalized.Signal + sd))
```

###individual data and group means plot
```{r}
#essentially what I want
#mean is indicated in red
#lost detail at the level of individual data points because present code cannot indicate biological and technical replicates

ggplot(heart,aes(x = Genotype,
                 y = Normalized.Signal))+
  geom_point(aes(color = Name,
                 shape = Replicate),
             alpha = 0.2)+
  geom_errorbar(data = heart_sum1,
                aes(ymin = Normalized.Signal-sd,
                    ymax = Normalized.Signal+sd,
                    width = 0.2))+
  geom_point(data = heart_sum1,
             size = 0.4,
             color = "red")+
  xlab("Naa10 genotype")+
  ylab("NAA10 signal normalized to
       REVERT total protein stain")+
  ggtitle("NAA10 levels in Naa10
          heterozygous mutant heart")
```





###dplyr group data
```{r}

```



##Unpaired t-test of NAA10 signal
```{r}
t.test(heart$Normalized.Signal~heart$Genotype,
       paired = F,
       var.equal = FALSE)
```
Null hypothesis: there is no mean difference in NAA10 signal between Naa10 female
genotypes

Alternative: there is a difference in NAA10 signal between Naa10 female genotypes

According to Welch's two sample t-test, there is a significant difference in
NAA10 signal between Naa10 female genotypes.

#Other plot ideas
```{r}
#plotted error bars for intra-subject variation
#need also group error bar (mean +/- sd)
gg_heart <- ggplot(heart,aes(x = Genotype,
                 y = Normalized.Signal,
                 color = Name,
                 shape = Replicate))+
  geom_point()+
  ylab("NAA10 signal normalized to
       REVERT total protein stain")+
  ggtitle("NAA10 levels in Naa10
          heterozygous mutant heart")

gg_heart+
  geom_errorbar(aes(ymin = Avg..Norm..Signal-Std..Dev.,
                           ymax = Avg..Norm..Signal+Std..Dev.,),
                position = "dodge",
                width = 0.2)

```

```{r}
ggplot(heart,aes(x = Genotype,
                 y = Normalized.Signal,
                 color = Name,))+
  geom_point()+
  geom_errorbar(aes(ymin = Avg..Norm..Signal-Std..Dev.,
                    ymax = Avg..Norm..Signal+Std..Dev.,
                    width = 0.2))+
  ylab("NAA10 signal normalized to
       REVERT total protein stain")+
  ggtitle("NAA10 levels in Naa10
          heterozygous mutant heart")
```


###Plotted by biological replicate
```{r}
ggplot(heart, aes(x = Name,
                  y = Normalized.Signal,
                  shape = Replicate,
                  color = Genotype))+
         geom_point()+
  xlab("sample ID")+
  ylab("NAA10 signal normalized to
       REVERT total protein stain")+
   ggtitle("NAA10 levels in Naa10
          heterozygous mutant heart")

##verify genotypes of 4942 and 4924 (may be flipped in source data)
```




This plots absolute signal and indicates biological replicate (color) and
technical replicate (shape)


```{r}
heart_fold <- read.csv("https://docs.google.com/spreadsheets/d/e/2PACX-1vQ6Zsk-kGVqB3DlzX_VtZE5cRNqqM5NX5rfdp5t1kuEkH6PAKf76ozEFmqklqKIFZqWvjzcx_mOV5K6/pub?gid=194880494&single=true&output=csv",
                       header = T)

head(heart_fold)
```

```{r}
ggplot(heart, aes(x = Genotype,
                       y = fold.change))+
  geom_point()

```



Considerations for the genotype analysis

1. Plot mean change of biological replicates (ie, each sample was blotted 2 times as of 10 January 2022)
2. Express data as fold-changes of groups
  a. Return to source data
3. normalize Naa10 +/+ to 1.0